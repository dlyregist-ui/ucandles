<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <title>Gift Set Builder</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- React + ReactDOM с CDN -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <style>
      body {
        font-family: sans-serif;
        margin: 0;
        padding: 20px;
        background: #f3f4f6;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useMemo, useEffect } = React;

      /* UI helpers */
      const Card = ({ children, style }) => (
        <div style={{border:"1px solid #e5e7eb",borderRadius:16,padding:16,background:"#fff",...style}}>{children}</div>
      );
      const Button = ({ children, onClick, disabled, variant="primary" }) => (
        <button onClick={onClick} disabled={disabled}
          style={{
            padding:"10px 14px",borderRadius:12,
            border: variant==="ghost"?"1px solid transparent":"1px solid #111",
            background: disabled?"#f3f4f6":variant==="ghost"?"transparent":"#111",
            color: disabled?"#9ca3af":variant==="ghost"?"#111":"#fff",
            cursor:disabled?"not-allowed":"pointer",fontWeight:600
          }}>{children}</button>
      );
      const Badge = ({ children }) => (
        <span style={{border:"1px solid #e5e7eb",borderRadius:999,padding:"4px 10px",fontSize:12,background:"#f9fafb"}}>{children}</span>
      );

      const Modal = ({open,onClose,title,children})=>{
        if(!open) return null;
        return (
          <div style={{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",display:"grid",placeItems:"center"}}
            onClick={onClose}>
            <div onClick={e=>e.stopPropagation()} style={{background:"#fff",borderRadius:16,padding:20,maxWidth:600,width:"90%"}}>
              <div style={{display:"flex",justifyContent:"space-between",marginBottom:10}}>
                <h3>{title}</h3>
                <button onClick={onClose} style={{fontSize:20,border:"none",background:"transparent",cursor:"pointer"}}>×</button>
              </div>
              {children}
            </div>
          </div>
        );
      };

      const BOXES = [
        {id:"small", name:"Набор малый", price:2000, image:"179A9273.jpg", slots:["диффузор","свеча","автопарфюм"]},
        {id:"medium", name:"Набор средний", price:3500, image:"179A9301.jpg", slots:["диффузор","мыло","лосьон","свеча","свеча","скраб","бомбочка","автопарфюм"]},
        {id:"large", name:"Набор большой", price:5000, image:"179A9329.jpg", slots:["диффузор","диффузор","мыло","лосьон","свеча","свеча","свеча","скраб","скраб","бомбочка","бомбочка","бомбочка"]},
      ];
      const AROMAS = {
        "диффузор":[{name:"Arabian Nights"},{name:"Astoria Lux"}],
        "свеча":[{name:"Mango Kiss"},{name:"Smoked Vanilla"}],
        "автопарфюм":[{name:"Royal Roses"}],
        "мыло":[{name:"Celtic Verbena"}],
        "лосьон":[{name:"Celtic Verbena"}],
        "скраб":[{name:"Basil & Mint"}],
        "бомбочка":[{name:"Basil & Mint"}]
      };

      function App(){
        const [box,setBox]=useState(null);
        const [selections,setSelections]=useState([]);
        const [detail,setDetail]=useState(null);

        const isComplete = box && selections.length===box.slots.length && selections.every(x=>x);

        const addAroma=(i,ar)=>{const next=[...selections]; next[i]=ar; setSelections(next);};

        if(!box){
          return (
            <div style={{display:"grid",gap:16}}>
              {BOXES.map(b=>
                <Card key={b.id}>
                  <h3>{b.name} <Badge>{b.price} ₽</Badge></h3>
                  <Button onClick={()=>{setBox(b);setSelections(b.slots.map(()=>null));}}>Выбрать</Button>
                </Card>)}
            </div>
          );
        }

        return (
          <div>
            <h2>{box.name}</h2>
            {box.slots.map((slot,i)=>(
              <div key={i} style={{margin:"10px 0"}}>
                <b>{slot}</b>: {selections[i]?.name||"—"}
                <div style={{display:"flex",gap:8,overflowX:"auto"}}>
                  {(AROMAS[slot]||[]).map((ar,j)=>(
                    <Card key={j} style={{minWidth:150}}>
                      <div>{ar.name}</div>
                      <Button onClick={()=>setDetail(ar)} variant="ghost">Подробнее</Button>
                      <Button onClick={()=>addAroma(i,ar)}>Выбрать</Button>
                    </Card>
                  ))}
                </div>
              </div>
            ))}
            <h3>Стоимость: {box.price} ₽</h3>
            <Button disabled={!isComplete}>Добавить в корзину</Button>

            <Modal open={!!detail} onClose={()=>setDetail(null)} title={detail?.name}>
              <p>Описание аромата {detail?.name || ""} будет добавлено.</p>
            </Modal>
          </div>
        );
      }

      ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
    </script>

    <!-- Подключаем Babel для JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </body>
</html>
